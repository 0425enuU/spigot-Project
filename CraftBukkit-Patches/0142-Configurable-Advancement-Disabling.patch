From 5d73659ba796635445459e7bb21b11a46fad1368 Mon Sep 17 00:00:00 2001
From: md_5 <git@md-5.net>
Date: Fri, 9 Jun 2017 16:29:31 +1000
Subject: [PATCH] Configurable Advancement Disabling

Allow disabling any (or all) inbuilt advancements with a configuration option.

diff --git a/src/main/java/net/minecraft/server/AdvancementDataWorld.java b/src/main/java/net/minecraft/server/AdvancementDataWorld.java
index 5ae0609d8..39a603326 100644
--- a/src/main/java/net/minecraft/server/AdvancementDataWorld.java
+++ b/src/main/java/net/minecraft/server/AdvancementDataWorld.java
@@ -153,6 +153,11 @@ public class AdvancementDataWorld {
                         java.nio.file.Path java_nio_file_path2 = java_nio_file_path.relativize(java_nio_file_path1);
                         String s = FilenameUtils.removeExtension(java_nio_file_path2.toString()).replaceAll("\\\\", "/");
                         MinecraftKey minecraftkey = new MinecraftKey("minecraft", s);
+                        // Spigot start
+                        if (org.spigotmc.SpigotConfig.disabledAdvancements.contains("*") || org.spigotmc.SpigotConfig.disabledAdvancements.contains(minecraftkey.toString())) {
+                            continue;
+                        }
+                        // Spigot end
 
                         if (!map.containsKey(minecraftkey)) {
                             BufferedReader bufferedreader = null;
diff --git a/src/main/java/org/spigotmc/SpigotConfig.java b/src/main/java/org/spigotmc/SpigotConfig.java
index 4b21fa599..80068e285 100644
--- a/src/main/java/org/spigotmc/SpigotConfig.java
+++ b/src/main/java/org/spigotmc/SpigotConfig.java
@@ -392,4 +392,9 @@ public class SpigotConfig
     private static void itemDirtyTicks() {
         itemDirtyTicks = getInt("settings.item-dirty-ticks", 20);
     }
+
+    public static List<String> disabledAdvancements;
+    private static void disabledAdvancements() {
+        disabledAdvancements = getList("disabled-advancements", Arrays.asList(new String[]{"minecraft:story/disabled"}));
+    }
 }
-- 
2.11.0

