From 80a22dc2c4c0d1f7dddb6f97663a40784b0efef0 Mon Sep 17 00:00:00 2001
From: md_5 <md_5@bigpond.com>
Date: Thu, 10 Jan 2013 12:33:37 +1100
Subject: [PATCH] Update timeout time to new default value.

---
 src/main/java/org/bukkit/craftbukkit/Spigot.java | 9 ++++++++-
 src/main/resources/configurations/bukkit.yml     | 2 +-
 2 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/src/main/java/org/bukkit/craftbukkit/Spigot.java b/src/main/java/org/bukkit/craftbukkit/Spigot.java
index e11aee4..2b0362a 100644
--- a/src/main/java/org/bukkit/craftbukkit/Spigot.java
+++ b/src/main/java/org/bukkit/craftbukkit/Spigot.java
@@ -8,7 +8,14 @@ public class Spigot {
         commandMap.register("bukkit", new org.bukkit.craftbukkit.command.RestartCommand("restart"));
         commandMap.register("bukkit", new org.bukkit.craftbukkit.command.TicksPerSecondCommand("tps"));
 
-        org.bukkit.craftbukkit.util.WatchdogThread.startThread(configuration.getInt("settings.timeout-time", 180), configuration.getBoolean("settings.restart-on-crash", false));
+        int timeout = configuration.getInt("settings.timeout-time", 300);
+        if (timeout == 180) {
+            timeout = 300;
+            server.getLogger().info("Migrating to new timeout time of 300");
+            configuration.set("settings.timeout-time", timeout);
+            server.saveConfig();
+        }
+        org.bukkit.craftbukkit.util.WatchdogThread.startThread(timeout, configuration.getBoolean("settings.restart-on-crash", false));
 
         server.whitelistMessage = configuration.getString("settings.whitelist-message", server.whitelistMessage);
         server.stopMessage = configuration.getString("settings.stop-message", server.stopMessage);
diff --git a/src/main/resources/configurations/bukkit.yml b/src/main/resources/configurations/bukkit.yml
index e192700..78134f9 100644
--- a/src/main/resources/configurations/bukkit.yml
+++ b/src/main/resources/configurations/bukkit.yml
@@ -26,7 +26,7 @@ settings:
     deprecated-verbose: default
     shutdown-message: Server closed
     restart-script-location: start.bat
-    timeout-time: 180
+    timeout-time: 300
     restart-on-crash: false
     filter-unsafe-ips: false
     whitelist-message: You are not white-listed on this server!
-- 
1.8.0.3

