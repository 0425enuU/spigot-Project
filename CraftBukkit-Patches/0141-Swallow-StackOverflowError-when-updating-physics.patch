From 68d31fb7ae5082fdb5cb31fe42304d751028a92e Mon Sep 17 00:00:00 2001
From: David <dmck2b@gmail.com>
Date: Mon, 21 Apr 2014 17:00:53 +1000
Subject: [PATCH] Swallow StackOverflowError when updating physics.

Prevents an otherwise unneeded crash.

diff --git a/src/main/java/net/minecraft/server/World.java b/src/main/java/net/minecraft/server/World.java
index 52ed625..6dcf6ee 100644
--- a/src/main/java/net/minecraft/server/World.java
+++ b/src/main/java/net/minecraft/server/World.java
@@ -531,6 +531,10 @@ public abstract class World implements IBlockAccess {
                 // CraftBukkit end
 
                 block1.doPhysics(this, i, j, k, block);
+                // Spigot start - Prevent NoClassDefFoundError and unneeded crash
+            } catch (StackOverflowError ignore) {
+                Bukkit.getLogger().severe("Encountered stack overflow whilst updating neighbours");
+                // Spigot end
             } catch (Throwable throwable) {
                 CrashReport crashreport = CrashReport.a(throwable, "Exception while updating neighbours");
                 CrashReportSystemDetails crashreportsystemdetails = crashreport.a("Block being updated");
-- 
1.9.1

